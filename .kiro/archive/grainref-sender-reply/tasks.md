# 実装計画

- [x] 1. sender 指定 API の基本フロー追加
- [x] 1.1 sender 指定の送信/要求が既存の解決・リトライ・タイムアウトの流れを踏襲するよう統合する
  - sender 指定でも既存の解決手順とオプション解釈を維持する
  - sender 未指定時の挙動を変えない
  - _Requirements: 1.1, 1.2, 1.3, 1.4, 2.2_
- [x] 1.2 送信者の識別がユーザ指定 ActorRef と一致するよう sender 情報を整合させる
  - 返信経路のための内部ラップは行いつつ、メッセージ上の sender を指定 ActorRef と一致させる
  - 返信は送信者へ配送され、呼び出し側の future は Result 成功で完了する
  - _Requirements: 1.1, 1.5, 2.1_
- [x] 1.3 完了時のクリーンアップを成功/失敗の双方で保証する
  - temp reply actor の登録解除を確実に行い、リークを防止する
  - sender 指定/未指定の混在でも返信先が取り違えられないようにする
  - _Requirements: 2.3_

- [x] 2. 失敗処理とイベント通知の整合
- [x] 2.1 解決失敗/送信失敗/タイムアウトを Result 失敗として完了させる
  - 呼び出し側が失敗理由を Result で判別できるようにする
  - EventStream 通知と一貫した失敗理由を維持する
  - _Requirements: 1.6, 3.1, 3.2, 3.3_
- [x] 2.2 返信転送失敗を送信失敗として扱い、同じ失敗経路に統合する
  - 失敗時に future が失敗で完了し、失敗通知が送られることを保証する
  - _Requirements: 1.6, 3.3_

- [x] 3. テストで sender 指定のふるまいを担保する
- [x] 3.1 sender 指定の成功ケースで、返信配送と Result 完了が一致することを確認する
  - 送信者に返信が届き、future が成功で完了することを検証する
  - _Requirements: 1.5, 2.1_
- [x] 3.2 失敗ケースで Result が失敗になることを確認する
  - 解決失敗/送信失敗/タイムアウト/転送失敗を検証する
  - EventStream 通知が行われることを検証する
  - _Requirements: 1.6, 3.1, 3.2, 3.3_
- [x] 3.3 sender 指定と未指定が混在しても取り違えやリークが起きないことを確認する
  - temp reply actor のクリーンアップが成功/失敗で行われることを検証する
  - _Requirements: 2.2, 2.3_

- [x] 4. 例を更新して sender 指定 API の使い方を示す
- [x] 4.1 標準環境の例で sender 指定の往復を示す
  - 送信者がアクターの場合の返信受信を示す
  - _Requirements: 4.1, 4.2_
- [x] 4.2 no_std の例で sender 指定の往復を示す
  - 送信者指定の返信経路が確認できるようにする
  - _Requirements: 4.1, 4.2_
