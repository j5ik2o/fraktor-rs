# become/unbecome を現時点で必須にしない判断メモ（2026-02-09）

## 結論

`become/unbecome`（classic スタック遷移）は、現時点では必須ではない。

## 判断理由

1. 現在の typed API は `Behavior` 遷移と `stash/unstash_all` で主要ユースケースを満たせる。  
   とくに `with_stash` で、メッセージ保留と明示的再投入の流れは実装済み。
2. `become/unbecome` を導入すると、挙動スタック管理・再起動時の整合・境界条件テストが増え、実装と保守の複雑性が上がる。
3. 現在の要件では「classic API の完全互換」までは明示されておらず、YAGNI の観点で先行実装の優先度は低い。

## いま維持している互換レベル

- `typed` で `with_stash` を提供
- `stash()` / `unstash_all()` を明示 API として提供
- 遷移時の自動 `unstash` は行わない（明示呼び出し前提）

## 将来 `become/unbecome` を実装すべき条件

以下のいずれかが満たされたら再評価する。

1. Pekko classic の既存コードをほぼそのまま移植する要求が出たとき
2. `discardOld=false` 相当の挙動スタックを必要とする具体ユースケースが出たとき
3. プロジェクト方針として「classic API 互換」を明示したとき

## 補足

この判断は「不要」ではなく「現時点では優先しない」という意味。  
要求が具体化した時点で、破壊的変更を許容する方針に沿って実装を進める。
